@model sc_web.Models.Chair.SmartChairModel
@{
    ViewBag.Title = "Smart Chair Data";
}

<h2>@Model.Name Smart Chair</h2>

<div class="container-fluid h-100">
    <div class="row h-100">
        <aside class="col-12 col-md-2 p-0 bg-dark">
            <nav class="navbar navbar-expand navbar-dark bg-dark flex-md-column flex-row align-items-start py-2">
                <div class="collapse navbar-collapse">
                    <ul class="flex-md-column flex-row navbar-nav w-100 justify-content-between">
                        <li class="nav-item">
                            <a class="nav-link pl-0" data-toggle="collapse" data-parent="#chairDataGroup" href="#collapseOverview"><span data-feather="file"></span><span class="font-weight-bold pl-1">Overview</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link pl-0" data-toggle="collapse" data-parent="#chairDataGroup" href="#collapsePosture"><span data-feather="user-check"></span><span class="font-weight-bold pl-1">Posture</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link pl-0" data-toggle="collapse" data-parent="#chairDataGroup" href="#collapseHeart"><span data-feather="heart"></span><span class="font-weight-bold pl-1">Heart</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link pl-0" data-toggle="collapse" data-parent="#chairDataGroup" href="#collapseMotion"><span data-feather="activity"></span><span class="font-weight-bold pl-1">Motion</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link pl-0" data-toggle="collapse" data-parent="#chairDataGroup" href="#collapseSitting"><span data-feather="coffee"></span><span class="font-weight-bold pl-1">Sitting</span></a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>
        <main class="col bg-faded py-3">

            @using (Html.BeginForm(null, null, FormMethod.Get, new { id = "selectorform" }))
            {
                <input id="WebKey" name="WebKey" type="hidden" value="@Model.WebKey">
                <input id="TimeRange" name="TimeRange" type="hidden">

                <button class="btn btn-sm btn-outline-secondary dropdown-toggle float-sm-right" id="timeSelectorBtn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span data-feather="calendar"></span>
                    @ViewBag.RangeString
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="#" onclick="$('#TimeRange').val('today'); $('#selectorform').submit()">Today</a>
                    <a class="dropdown-item" href="#" onclick="$('#TimeRange').val('thisweek'); $('#selectorform').submit()">This Week</a>
                    <a class="dropdown-item" href="#" onclick="$('#TimeRange').val('thismonth'); $('#selectorform').submit()">This Month</a>
                </div>
            }


            <div id="chairDataGroup">
                <div class="collapse show" id="collapseOverview">
                    <h2>Overview</h2>
                    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
                </div>

                <div class="collapse" id="collapsePosture">
                    <h2>Posture</h2>
                    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
                </div>

                <div class="collapse" id="collapseHeart">
                    <h2>Heart</h2>
                    
                    
                    
                        <div style="width:75%;">
                            <canvas id="canvas"></canvas>
                        </div>
                        <br>
                        <br>
                        <button id="randomizeData">Randomize Data</button>
                        <button id="addDataset">Add Dataset</button>
                        <button id="removeDataset">Remove Dataset</button>
                        <button id="addData">Add Data</button>
                        <button id="removeData">Remove Data</button>
                        <script>
                            var MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                            var config = {
                                type: 'line',
                                data: {
                                    labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
                                    datasets: [{
                                        label: 'My First dataset',
                                        backgroundColor: window.chartColors.red,
                                        borderColor: window.chartColors.red,
                                        data: [
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor()
                                        ],
                                        fill: false,
                                    }, {
                                        label: 'My Second dataset',
                                        fill: false,
                                        backgroundColor: window.chartColors.blue,
                                        borderColor: window.chartColors.blue,
                                        data: [
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor(),
                                            randomScalingFactor()
                                        ],
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    title: {
                                        display: true,
                                        text: 'Chart.js Line Chart'
                                    },
                                    tooltips: {
                                        mode: 'index',
                                        intersect: false,
                                    },
                                    hover: {
                                        mode: 'nearest',
                                        intersect: true
                                    },
                                    scales: {
                                        xAxes: [{
                                            display: true,
                                            scaleLabel: {
                                                display: true,
                                                labelString: 'Month'
                                            }
                                        }],
                                        yAxes: [{
                                            display: true,
                                            scaleLabel: {
                                                display: true,
                                                labelString: 'Value'
                                            }
                                        }]
                                    }
                                }
                            };
                            
                            window.onload = function () {
                                var ctx = document.getElementById('canvas').getContext('2d');
                                window.myLine = new Chart(ctx, config);
                            };    
                            

                            document.getElementById('randomizeData').addEventListener('click', function () {
                                config.data.datasets.forEach(function (dataset) {
                                    dataset.data = dataset.data.map(function () {
                                        return randomScalingFactor();
                                    });

                                });

                                window.myLine.update();
                            });

                            var colorNames = Object.keys(window.chartColors);
                            document.getElementById('addDataset').addEventListener('click', function () {
                                var colorName = colorNames[config.data.datasets.length % colorNames.length];
                                var newColor = window.chartColors[colorName];
                                var newDataset = {
                                    label: 'Dataset ' + config.data.datasets.length,
                                    backgroundColor: newColor,
                                    borderColor: newColor,
                                    data: [],
                                    fill: false
                                };

                                for (var index = 0; index < config.data.labels.length; ++index) {
                                    newDataset.data.push(randomScalingFactor());
                                }

                                config.data.datasets.push(newDataset);
                                window.myLine.update();
                            });

                            document.getElementById('addData').addEventListener('click', function () {
                                if (config.data.datasets.length > 0) {
                                    var month = MONTHS[config.data.labels.length % MONTHS.length];
                                    config.data.labels.push(month);

                                    config.data.datasets.forEach(function (dataset) {
                                        dataset.data.push(randomScalingFactor());
                                    });

                                    window.myLine.update();
                                }
                            });

                            document.getElementById('removeDataset').addEventListener('click', function () {
                                config.data.datasets.splice(0, 1);
                                window.myLine.update();
                            });

                            document.getElementById('removeData').addEventListener('click', function () {
                                config.data.labels.splice(-1, 1); // remove the label first

                                config.data.datasets.forEach(function (dataset) {
                                    dataset.data.pop();
                                });

                                window.myLine.update();
                            });
                        </script>
                    
                </div>

                <div class="collapse" id="collapseMotion">
                    <h2>Motion</h2>
                    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
                </div>

                <div class="collapse" id="collapseSitting">
                    <h2>Sitting</h2>
                    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
                </div>
            </div>
        </main>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/feather")
    
    <script>
           feather.replace()
    </script>

    <script>
        var $myGroup = $('#chairDataGroup');
        $myGroup.on('show.bs.collapse', '.collapse', function () {
            $myGroup.find('.collapse.show').collapse('hide');
        });
    </script>
}



